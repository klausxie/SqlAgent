<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>cn.mklaus.sqlagent</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>SQL Agent</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor url="https://github.com/mklaus">Klaus</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and in IDE Plugin Manager.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
    <p>AI-powered SQL optimization assistant for IntelliJ IDEA.</p>
    <p>SQL Agent helps you optimize your SQL queries by leveraging OpenCode AI to analyze:</p>
    <ul>
      <li>Performance issues and indexing opportunities</li>
      <li>Query execution plans</li>
      <li>SQL syntax and best practices</li>
      <li>Resource usage and cost optimization</li>
    </ul>
    <p><strong>Features:</strong></p>
    <ul>
      <li>Right-click on any SQL to optimize with AI</li>
      <li>Click gutter icons in MyBatis mapper XML files to optimize SQL statements</li>
      <li>Real-time metadata analysis from your database</li>
      <li>Side-by-side diff view of original and optimized SQL</li>
      <li>Support for MySQL and PostgreSQL</li>
    </ul>
  ]]></description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends config-file="with-java.xml" optional="true">com.intellij.java</depends>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Application service for plugin settings -->
        <applicationService serviceImplementation="cn.mklaus.sqlagent.SqlAgentSettings"/>

        <!-- Application configurable for plugin settings -->
        <applicationConfigurable parentId="tools"
                                 instance="cn.mklaus.sqlagent.config.SqlAgentConfigurable"
                                 id="cn.mklaus.sqlagent"
                                 displayName="SQL Agent"/>

        <!-- Startup activity for first-run wizard -->
        <postStartupActivity implementation="cn.mklaus.sqlagent.FirstRunStartupActivity"/>

        <!-- SQL optimization inspection -->
        <localInspection displayName="SQL Optimization"
                         groupName="SqlAgent"
                         enabledByDefault="true"
                         language="XML"
                         implementationClass="cn.mklaus.sqlagent.inspection.SqlOptimizationInspection"
                         shortName="SqlOptimization"/>

        <!-- Tool Window for displaying optimization results -->
        <toolWindow id="SQL Agent"
                    anchor="right"
                    icon="/META-INF/pluginIcon.svg"
                    factoryClass="cn.mklaus.sqlagent.ui.OptimizationToolWindowFactory"/>

        <!-- Line Marker Provider for MyBatis Mapper XML files -->
        <codeInsight.lineMarkerProvider language="XML"
                                        implementationClass="cn.mklaus.sqlagent.mybatis.MyBatisSqlLineMarkerProvider"/>
    </extensions>

    <!-- Actions for plugin functionality -->
    <actions>
        <action id="SqlAgent.Optimize"
                class="cn.mklaus.sqlagent.ui.OptimizeSqlAction"
                text="Optimize SQL with AI"
                description="Optimize selected SQL using OpenCode AI">
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift O"/>
        </action>

        <action id="SqlAgent.ShowSetupWizard"
                class="cn.mklaus.sqlagent.ui.ShowWizardAction"
                text="Show Setup Wizard"
                description="Show SqlAgent setup wizard">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
